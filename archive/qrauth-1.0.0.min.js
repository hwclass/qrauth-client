var qrauth=function(){var e=function(){return function(e,t){var n=new Object;return n.appId=e,n.appSecret=t,{appId:n.appId,appSecret:n.appSecret,getAppId:function(){return n.appId},getAppSecret:function(){return n.appSecret},setAppId:function(e){n.appId=e},setAppSecret:function(e){n.appSecret=e}}}}(),t=function(t){var r=null,c=null;n.getScript(o.urls.socketIO,function(){r=io(o.urls.auth),r.on("connect",function(){r.on("join",function(r){n.getScript(o.urls.qrCode,function(){var a=new e(t.appId,t.appSecret);n.ajax(o.urls.auth,"GET",a,"json","application/json",function(){},function(e){if(e.success){$(o.els.accessToken).val(e.accessToken);var t=document.getElementById("qrauth");c=new QRCode(t,{width:$(t).attr("width"),height:$(t).attr("height"),colorDark:$(t).attr("color-dark"),colorLight:$(t).attr("color-light"),correctLevel:QRCode.CorrectLevel.L});var n=$(o.els.accessToken).val();if(!r.uid||!n)return;var a=r.uid+"_"+n;c.makeCode(a)}else console.log(o.messages.error["default"])},function(e){console.log(e)})})}),r.on("redirect",function(e){window.location.href=e}),r.on("disconnect",function(){n.clearCode(c)})})})},n=function(){return{ajax:function(e,t,n,o,r,c,a,i){return $.ajax({url:e,type:t,data:n,dataType:o,contentType:r,beforeSend:c,success:a,error:i})},getScript:function(e,t){return $.ajax({url:e,dataType:"script",async:!1,success:t,error:function(e){console.dir(e)}})},clearCode:function(e){e.clear()}}}(),o=function(){return{els:{accessToken:"#accessToken"},urls:{qrCode:"http://davidshimjs.github.com/qrcodejs/qrcode.min.js",socketIO:"https://cdn.socket.io/socket.io-1.3.5.js",auth:"http://localhost:3000/auth"},messages:{error:{"default":"There is a problem with the authentication URL to fetch QRCode."}}}}();return{init:t}}();