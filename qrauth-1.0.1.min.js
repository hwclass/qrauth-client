var qrauth=function(){var e=function(){return function(e,t){var n=new Object;return n.appId=e,n.appSecret=t,{appId:n.appId,appSecret:n.appSecret,getAppId:function(){return n.appId},getAppSecret:function(){return n.appSecret},setAppId:function(e){n.appId=e},setAppSecret:function(e){n.appSecret=e}}}}(),t=function(t){var o=null,c=null;n.getScript(r.urls.socketIO,function(){o=io(r.urls.auth),o.on("connect",function(){o.on("join",function(o){n.getScript(r.urls.qrCode,function(){var a=new e(t.appId,t.appSecret);n.ajax(r.urls.auth,"GET",a,"json","application/json",function(){},function(e){if(e.success){if(!n.checkIfQrCodeExists()){$(r.els.accessToken).val(e.accessToken);var t=document.getElementById("qrauth");c=new QRCode(t,{width:$(t).attr("width"),height:$(t).attr("height"),colorDark:$(t).attr("color-dark"),colorLight:$(t).attr("color-light"),correctLevel:QRCode.CorrectLevel.L});var a=$(r.els.accessToken).val();if(!o.uid||!a)return;var u=o.uid+"_"+a;c.makeCode(u)}}else console.log(r.messages.error["default"])},function(e){console.log(e)})})}),o.on("redirect",function(e){window.location.href=e}),o.on("disconnect",function(){n.clearCode()})})})},n=function(){return{ajax:function(e,t,n,r,o,c,a,u){return $.ajax({url:e,type:t,data:n,dataType:r,contentType:o,beforeSend:c,success:a,error:u})},getScript:function(e,t){return $.ajax({url:e,dataType:"script",async:!1,success:t,error:function(e){console.dir(e)}})},clearCode:function(){$("#qrauth").html().length>0&&$("#qrauth").html("")},checkIfQrCodeExists:function(){return $("#qrauth").html().length>0?!0:!1}}}(),r=function(){return{els:{accessToken:"#accessToken"},urls:{qrCode:"http://davidshimjs.github.com/qrcodejs/qrcode.min.js",socketIO:"https://cdn.socket.io/socket.io-1.3.5.js",auth:"http://localhost:3000/auth"},messages:{error:{"default":"There is a problem with the authentication URL to fetch QRCode."}}}}();return{init:t}}();